<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="gfs-checkout-data.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">
<link rel="import" href="../paper-expansion-panel/paper-expansion-panel.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">

<!--
`gfs-checkout`
A better GFS Checkout web component implementation

@demo demo/index.html
-->

<dom-module id="gfs-checkout">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <gfs-checkout-data id="server"
      checkout-token="[[checkoutToken]]"
      checkout-request="[[checkoutRequest]]"
      checkout-uri="[[checkoutUri]]"
      on-getoptionscomplete="_newOptions"></gfs-checkout-data>

    <paper-dialog id="dayDefiniteDialog" modal entry-animation="fade-in-animation" exit-animation="fade-out-animation">
      <h2>Select delivery time</h2>
      <gfs-checkout-date-definite-selector></gfs-checkout-date-definite-selector>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm autofocus>Save</paper-button>
      </div>
    </paper-dialog>

    <paper-dialog id="addressEntryDialog" modal entry-animation="fade-in-animation" exit-animation="fade-out-animation">
      <h2>Delivery address</h2>
      <gfs-checkout-address-entry id="addressEditor" recipient-name="[[recipientName]]" company="[[company]]" address="[[address}}" city="[[city]]" region="[[region]]" postcode='[[postcode]]'></gfs-checkout-address-entry>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm autofocus>Save</paper-button>
      </div>
    </paper-dialog>

    <paper-dialog id="dropPointMapDialog" modal entry-animation="fade-in-animation" exit-animation="fade-out-animation">
      <h2>Select Click+Collect location</h2>
      <gfs-checkout-droppoint-entry postcode="[[postcode]]"></gfs-checkout-droppoint-entry>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button dialog-confirm autofocus>Save</paper-button>
      </div>
    </paper-dialog>

    <paper-expansion-panel header="When would you like your delivery?" summary="[[_selectedServiceSummary]]">
      <div class="card-content">
        <paper-radio-group selected="{{selectedService}}" id="serviceSelection">
          <paper-radio-button name="asap" id="asap">As soon as possible (£5.00)</paper-radio-button></br>
          <paper-radio-button name="non-day-definite">2-4 days (£3.50)</paper-radio-button></br>
          <paper-radio-button name="day-definite" id="dayDefinite">Select a time and date (from £5.00)</paper-radio-button><paper-button on-click="_showDayDefiniteDialog">Select delivery window...</paper-button></br>
        </paper-radio-group>
      </div>
    </paper-expansion-panel>

    <paper-expansion-panel header="Deliver to" summary="[[_deliveryAddressText]]">
      <paper-radio-group selected="address">
        <paper-radio-button name="address">My address</paper-radio-button><paper-button on-click="_showAddressDialog">Edit delivery address...</paper-button></br>
        <paper-radio-button name="droppoint" id="droppoint">Collect from Click &amp; Collect location</paper-radio-button><paper-button on-click="_showDropPointMap">Select Click+Collect location...</paper-button></br>
      </paper-radio-group>
    </paper-expansion-panel>
  </template>

  <script>
    class GfsCheckout extends Polymer.Element {
      static get is() {return 'gfs-checkout';}
    
      static get properties() {
        return {
          checkoutUri: {
            type: String,
            value: "http://rest-checkout.justshoutgfs.com/api"
          },
          checkoutRequest: {
            type: String,
            value: ""
          },
          checkoutToken: {
            type: String,
            value: ""
          }     
        }
      }
    
      _newOptions(e) {
        console.log('I have new options!');
      }
    
    }

     window.customElements.define(GfsCheckout.is, GfsCheckout);

  </script>
</dom-module>
